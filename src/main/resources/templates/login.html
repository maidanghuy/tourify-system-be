<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TOURIFY | Login</title>
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
    />
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
            rel="stylesheet"
    />
    <link
            href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
            rel="stylesheet"
    />
    <link rel="stylesheet" th:href="@{/css/login.css}">
</head>
<body>
<div class="wave-container" aria-hidden="true">
    <div class="wave"></div>
    <div class="wave"></div>
    <div class="wave"></div>
</div>


<div class="card-glass">
    <div class="left-panel d-none d-md-block"></div>


    <div class="right-panel">
        <div class="mb-4 fade-slide-in">
            <h2 class="fw-bold text-success mb-2 text-start">TOURIFY</h2>
            <p class="text-muted text-start" style="font-size: 0.95rem">
                Discover your next adventure with ease.
            </p>
        </div>


        <form>
            <div class="form-floating mb-4">
                <input
                        type="text" name="username" class="form-control"
                        id="username" placeholder="Username" required
                />
                <label for="username" ><i class="fa-solid fa-user me-2"></i>Username</label
                > </div>


            <div class="form-floating mb-4 position-relative">
                <input
                        type="password"
                        name="password"
                        class="form-control"
                        id="password"
                        placeholder="Password"
                        required
                />
                <label for="password">
                    <i class="fa-solid fa-lock me-2"></i>Password
                </label>
                <span class="eye-icon" onclick="togglePassword()">
              <i id="eyeIcon" class="fa-solid fa-eye-slash"></i>
            </span>
            </div>


            <div class="d-flex justify-content-between align-items-center mb-4">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="rememberMe" />
                    <label class="form-check-label" for="rememberMe"
                    >Remember me</label
                    >
                </div>
                <a
                        href="/tourify/forgot_password"
                        class="text-danger text-decoration-none"
                >Forgot Password?</a
                >
            </div>


            <div class="d-grid mb-4">
                <button class="btn btn-login" type="submit">Login</button>
            </div>


            <div class="text-center mb-4">
                Don‚Äôt have an account?
                <a href="./register" class="text-danger text-decoration-none"
                >Sign up</a
                >
            </div>


            <hr />
            <div class="text-center mb-3">Or login with</div>
            <div class="d-flex justify-content-between gap-3 social-login">
                <button type="button" class="btn social-btn facebook">
                    <i class="fab fa-facebook-f me-2"></i>Facebook
                </button>
                <button type="button" onclick="loginWithGoogle()" class="btn social-btn google">
                    <i class="fab fa-google me-2"></i>Google
                </button>
            </div>
        </form>
    </div>
</div>
<script th:src="@{/js/login.js}"></script>
<script>
    function loginWithGoogle() {
        window.location.href = "/tourify/oauth2/authorization/google";
    }

    window.addEventListener('DOMContentLoaded', async () => {
        if (window.location.pathname.includes("/oauth/success")) {
            try {
                const res = await fetch("/tourify/api/auth/oauth2/success", {
                    credentials: "include"
                });
                const data = await res.json();
                if (data.code === 1000) {
                    localStorage.setItem("access_token", data.result.token);
                    localStorage.setItem("username", data.result.userName);
                    alert("‚úÖ ƒêƒÉng nh·∫≠p b·∫±ng Google th√†nh c√¥ng!");
                    window.location.href = "/tourify"; // üéØ Chuy·ªÉn trang landing
                } else {
                    alert("‚ùå ƒêƒÉng nh·∫≠p th·∫•t b·∫°i: " + data.message);
                }
            } catch (e) {
                console.error("‚ùå L·ªói khi g·ªçi API l·∫•y token:", e);
                alert("‚ùå L·ªói kh√¥ng x√°c ƒë·ªãnh khi l·∫•y token.");
            }
        }
    });
</script>



</body>
</html>