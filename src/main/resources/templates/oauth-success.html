<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Đăng nhập bằng Google</title>
</head>
<body>
<p>Đang xử lý đăng nhập...</p>
<script>
    (async () => {
      try {
        const res = await fetch("/tourify/api/auth/oauth2/success", {
          credentials: "include"
        });
        const data = await res.json();
        if (data.code === 1000) {
          localStorage.setItem("accessToken", data.result.token);
          localStorage.setItem("username", data.result.userName);
          alert("✅ Đăng nhập bằng Google thành công!");
          window.location.href = "/tourify/landing";
        } else {
          alert("❌ Đăng nhập thất bại: " + data.message);
          window.location.href = "/tourify/login";
        }
      } catch (err) {
        console.error("❌ Lỗi khi xử lý OAuth2:", err);
        window.location.href = "/tourify/login";
      }
    })();
</script>
</body>
</html>